<UserControl x:Class="Mestr.UI.View.ClientView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:viewmodels="clr-namespace:Mestr.UI.ViewModels"
      d:DataContext="{d:DesignInstance Type=viewmodels:ClientViewModel}"
      mc:Ignorable="d" 
      d:DesignHeight="600" d:DesignWidth="900"
      Background="#F5F7FA">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Navigation Top Bar -->
        <Border Grid.Row="0" Style="{StaticResource NavigationBarStyle}">
            <Grid>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                    <Button Content="Projekter" 
                            Style="{StaticResource NavTabButtonStyle}"
                            Command="{Binding NavigateToDashboardCommand}"/>
                    
                    <Button Content="Kunder" 
                            Style="{StaticResource NavTabButtonStyle}"
                            Tag="Active"/>
                </StackPanel>

                <Button Command="{Binding OpenCompanyInfoCommand}"
                        Style="{StaticResource IconButton}"
                        ToolTip="Virksomhedsindstillinger"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Margin="10,0">
                    <Path Data="{StaticResource SettingsIconGeometry}"
                          Fill="{StaticResource PrimaryBrush}"
                          Width="24"
                          Height="24"
                          Stretch="Uniform"/>
                </Button>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1" Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" MinHeight="400" />
            </Grid.RowDefinitions>

            <!-- Add Client Button -->
            <StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                        Orientation="Horizontal" 
                        Margin="0,0,0,15">

                <Button Content="Tilføj klient" 
                        Command="{Binding NavigateToAddClientCommand}"
                        Style="{StaticResource PrimaryActionButton}"
                        HorizontalAlignment="Left" 
                        Margin="0,0,20,0"/>

            </StackPanel>

            <!-- Clients DataGrid -->
            <Border Grid.Row="1" 
                    Style="{StaticResource CardBorderStyle}"
                    MinHeight="400">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Grid.Resources>
                        <Style x:Key="RowStyle" TargetType="DataGridRow" BasedOn="{StaticResource DataGridRowStyle}">
                            <EventSetter Event="MouseLeftButtonUp" Handler="ClientRow_MouseLeftButtonUp"/>
                        </Style>
                    </Grid.Resources>

                    <TextBlock Grid.Row="0"
                               Text="Mine klienter" 
                               Style="{StaticResource SectionTitleStyle}"/>

                    <DataGrid Grid.Row="1" 
                              ItemsSource="{Binding Clients}"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              CanUserSortColumns="True"
                              BorderThickness="0"
                              Background="Transparent"
                              HeadersVisibility="Column"
                              GridLinesVisibility="Horizontal"
                              HorizontalGridLinesBrush="#EAEBEE"
                              ColumnHeaderStyle="{StaticResource DataGridHeaderStyle}"
                              CellStyle="{StaticResource DataGridCellStyle}"
                              RowStyle="{StaticResource RowStyle}"
                              Margin="15,0,15,15">
                        <DataGrid.InputBindings>
                            <MouseBinding MouseAction="LeftDoubleClick"
                                          Command="{Binding ViewClientDetailsCommand}"
                                          CommandParameter="{Binding SelectedItem.Uuid, RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                        </DataGrid.InputBindings>

                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Klient Navn" Binding="{Binding Name}" SortMemberPath="Name" Width="2*" />
                            <DataGridTextColumn Header="Kontaktperson" Binding="{Binding ContactPerson}" SortMemberPath="ContactPerson" Width="2*" />
                            <DataGridTextColumn Header="Email" Binding="{Binding Email}" SortMemberPath="Email" Width="2*" />
                            <DataGridTextColumn Header="Telefon" Binding="{Binding PhoneNumber}" SortMemberPath="PhoneNumber" Width="*" />
                            
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</UserControl>
